---
# file: roles/webservice/tasks/main.yml

- name: install easy_install
  apt: pkg=python-setuptools state=present
  sudo: yes

- name: install pip and virtual_env
  easy_install: name=${item}
  with_items:
    - pip
    - virtualenv
  sudo: yes

- name: install python requirements
  pip: requirements=/opt/mws/mongo-web-shell/requirements.txt virtualenv=/opt/mws/venv

- name: install python-dev
  apt: pkg=python-dev state=present
  sudo: yes

- name: install uwsgi
  pip: name=uwsgi virtualenv=/opt/mws/venv

- name: install nginx
  apt: pkg=nginx state=present
  sudo: yes

- name: install mws init file
  template: src=mws.conf.j2 dest=/etc/init/mws.conf mode=0644
  sudo: yes

- name: install mws nginx config
  template: src=mws.j2 dest=/etc/nginx/sites-enabled/mws mode=0644
  sudo: yes

- name: install ivs init file
  template: src=ivs.conf.j2 dest=/etc/init/ivs.conf mode=0644
  sudo: yes

- name: install ivs nginx config
  template: src=ivs.j2 dest=/etc/nginx/sites-enabled/ivs mode=0644
  sudo: yes
